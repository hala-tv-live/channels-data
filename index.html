<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="screen-orientation" content="portrait">
  <meta name="apple-mobile-web-app-orientation" content="portrait">
  <title>Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <style>
    /* Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
    :root {
      --primary-color: #1e88e5;
      --accent-color: #e53935;
      --light-color: #f5f5f5;
      --dark-color: #212121;
      --text-color: #333;
      --text-light: #fff;
      --shadow: 0 4px 6px rgba(0,0,0,0.1);
      --gradient-start: #e53935;
      --gradient-end: #1e88e5;
      --blue-btn: #1e88e5;
      --red-btn: #e53935;
      --search-bg: rgba(255, 255, 255, 0.95);
      --search-border: rgba(0, 0, 0, 0.1);
    }
    
    * {
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family:'Tajawal',sans-serif;
    }
    
    body {
      background: linear-gradient(135deg, var(--light-color) 0%, #e0e0e0 100%);
      color: var(--text-color);
      direction: rtl;
      min-height: 100vh;
      padding-bottom: 20px;
      overflow-x: hidden;
    }
    
    #loadingOverlay {
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(255,255,255,0.9);
      display:flex;
      flex-direction: column;
      align-items:center;
      justify-content:center;
      z-index:200;
      font-size:1.2rem;
      color: var(--red-btn);
    }
    
    .spinner {
      font-size: 3rem;
      margin-bottom: 20px;
      animation: spin 1.5s linear infinite;
    }
    
    @keyframes spin {
      from { transform:rotate(0deg); }
      to { transform:rotate(360deg); }
    }
    
    .modal {
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:rgba(0,0,0,0.6);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:300;
    }
    
    .modal.hidden {
      display:none;
    }
    
    .modal-content {
      background:var(--light-color);
      padding:20px;
      border-radius:10px;
      text-align:center;
      box-shadow: var(--shadow);
      max-width:90%;
      width: 320px;
    }
    
    .modal-content h3 {
      color: var(--accent-color);
      margin-bottom: 15px;
      font-size: 1.4rem;
    }
    
    .modal-content p {
      margin-bottom:20px;
      font-size:1.1rem;
      color:var(--text-color);
      line-height: 1.6;
    }
    
    .modal-content .info-link {
      display: block;
      margin: 15px auto;
      padding: 8px 15px;
      background: var(--primary-color);
      color: white;
      border-radius: 5px;
      text-decoration: none;
      width: fit-content;
      transition: all 0.3s;
    }
    
    .modal-content .info-link:hover {
      background: #0d47a1;
      transform: translateY(-2px);
    }
    
    .modal-content button {
      margin:10px 6px 0;
      padding:8px 16px;
      border:none;
      border-radius:6px;
      font-size:1.1rem;
      cursor:pointer;
      transition: all 0.3s;
      font-weight: bold;
    }
    
    .btn-blue {
      background: var(--blue-btn);
      color:var(--text-light);
    }
    
    .btn-blue:hover {
      background: #0d47a1;
      transform: translateY(-2px);
    }
    
    .btn-red {
      background: var(--red-btn);
      color:var(--text-light);
    }
    
    .btn-red:hover {
      background: #c62828;
      transform: translateY(-2px);
    }
    
    header {
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:70px;
      background:var( --accent-color);
      color:var(--text-light);
      display:flex;
      align-items:center;
      padding:0 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index:90;
      transition: all 0.3s ease;
    }
    
    header.scrolled {
      height: 60px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    header h1 {
      flex-grow:1;
      text-align:center;
      font-size:1.6rem;
      letter-spacing: -0.5px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }
    
    header.scrolled h1 {
      font-size: 1.4rem;
    }
    
    #menuToggle, #searchBtn {
      background:none;
      border:none;
      color:var(--text-light);
      font-size:1.9rem;
      cursor:pointer;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.3s;
    }
    
    #menuToggle:hover, #searchBtn:hover {
      background: rgba(255,255,255,0.2);
      transform: scale(1.05);
    }
    
    .search-container {
      position: relative;
      display: flex;
      align-items: center;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    #searchInput {
      width:0;
      padding:0;
      border:none;
      border-radius:30px;
      background: var(--search-bg);
      color: var(--text-color);
      transition: all .3s;
      opacity:0;
      font-size: 1rem;
      height: 40px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding-right: 40px;
      padding-left: 15px;
    }
    
    #searchInput::placeholder {
      color: #777;
      font-weight: normal;
    }
    
    #searchInput.active {
      width: 220px;
      padding: 0 35px 0 15px;
      opacity:1;
    }
    
    #searchInput:focus {
      outline: none;
      box-shadow: 0 2px 12px rgba(0,0,0,0.15);
      background: white;
    }
    
    #clearSearch {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      background: red;
      border: none;
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.3s;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    #clearSearch.visible {
      opacity: 1;
    }
    
    #clearSearch:hover {
      background: rgba(0,0,0,0.05);
    }
    
    #sidebar {
      position:fixed;
      top:0;
      right:-300px;
      width:300px;
      height:100%;
      background: linear-gradient(180deg, var(--dark-color) 0%, #111 100%);
      color:var(--text-light);
      transition:right .4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      overflow-y:auto;
      z-index:100;
      box-shadow: -5px 0 15px rgba(0,0,0,0.3);
    }
    
    #sidebar.open {
      right:0;
    }
    
    .sidebar-header {
      padding:20px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      border-bottom:1px solid rgba(255,255,255,0.1);
      background: url('https://images.unsplash.com/photo-1552667466-07770ae110d0?ixlib=rb-4.0.3') center/cover;
      opacity: 3.1;
      z-index: -1;
    }
    
    .logo-container {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .logo-container img {
      width: 70px;
      height: 70px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      background: linear-gradient(45deg, var(--gradient-start), var(--gradient-end));
    }
    
    .logo-text {
      font-size: 1.5rem;
      font-weight: bold;
      background: linear-gradient(45deg, #FFFFFF, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    #closeSidebar {
      background:none;
      border:none;
      color:var(--text-light);
      font-size:1.8rem;
      cursor:pointer;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.3s;
    }
    
    #closeSidebar:hover {
      background: rgba(255,255,255,0.1);
    }
    
    nav.categories a, .about-item {
      display:flex;
      align-items:center;
      padding:12px 20px;
      color:var(--text-light);
      text-decoration:none;
      transition:all .3s;
      font-size: 1.1rem;
      gap: 15px;
    }
    
    .about-link {
      display:flex;
      align-items:center;
      padding:12px 20px;
      color:#ffeb3b;
      text-decoration:none;
      transition:all .3s;
      font-size: 1.1rem;
      gap: 15px;
    }
    
    nav.categories a:hover, nav.categories a.active, 
    .about-item:hover, .about-link:hover {
      background:rgba(255,255,255,0.1);
      padding-right: 25px;
    }
    
    nav.categories a.active {
      border-right:4px solid var(--accent-color);
      background: rgba(229, 57, 53, 0.15);
    }
    
    nav.categories i, .about-item i, .about-link i {
      width: 24px;
      text-align: center;
    }
    
    .section-title {
      padding: 20px 20px 10px;
      font-size: 1.2rem;
      color: #bbb;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      margin-top: 6px;
    }
    
    .about-links {
      display: none;
      padding: 0;
    }
    
    .about-links.expanded {
      display: block;
    }
    
    main {
      padding-top:80px;
      transition: padding-top 0.3s ease;
    }
    
    header.scrolled + main {
      padding-top: 70px;
    }
    
    .channels-grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(170px,1fr));
      gap:20px;
      padding:20px;
      transition: all 0.3s ease;
    }
    
    .channel-card {
      position:relative;
      background:#fff;
      border-radius:6px;
      overflow:hidden;
      box-shadow: var(--shadow);
      transition:transform .2s,box-shadow .3s;
      cursor:pointer;
      border: 1px solid #eee;
      animation: fadeIn 0.5s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .channel-card:hover {
      transform:translateY(-8px);
      box-shadow:0 12px 25px rgba(0,0,0,0.2);
      border: 1px solid var(--accent-color);
    }
    
    .channel-img {
      width:100%;
      height:140px;
      object-fit:contain;
      padding:2px;
      background: #f9f9f9;
      transition: all 0.3s ease;
    }
    
    .channel-info {
      padding:5px 10px;
      text-align: center;
      background: linear-gradient(to bottom, #fff, #f5f5f5);
    }
    
    .channel-name {
      font-size:1rem;
      font-weight:bold;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      margin-bottom: 5px;
      color: #333;
    }
    
    .channel-category {
      font-size:.85rem;
      color:#Ffffff;
      background: #1e90ff;
      display: inline-block;
      padding: 3px 10px;
      border-radius: 20px;
    }
    
    #videoPlayer {
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:#000;
      z-index:110;
      display:none;
    }
    
    #closePlayer {
      position: absolute;
      top: 15px;
      right: 15px;
      background: rgba(0,0,0,0.5);
      color: white;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      font-size: 1rem;
      cursor: pointer;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      opacity: 0.7;
    }
    
    #closePlayer:hover {
      background: rgba(0,0,0,0.8);
      transform: scale(1.1);
      opacity: 1;
    }
    
    #player {
      width:100%;
      height:100%;
      object-fit:contain;
    }
    
    .plyr__controls {
      background:rgba(0,0,0,0.7);
    }
    
    .plyr__control {
      color:#fff;
    }
    
    .plyr__control:hover {
      color:var(---light-color)!important;
    }
    
    .no-results {
      grid-column: 1 / -1;
      text-align: center;
      padding: 40px 20px;
      font-size: 1.2rem;
      color: #666;
      animation: fadeIn 0.5s ease-out;
    }
    
    .no-results i {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #ddd;
    }
    
    .app-footer {
      text-align: center;
      padding: 20px;
      color: #666;
      font-size: 0.9rem;
      margin-top: 20px;
    }
    
    .app-footer a {
      color: var(--primary-color);
      text-decoration: none;
    }
    
    .app-footer a:hover {
      text-decoration: underline;
    }
    
    @media (max-width: 768px) {
      .channels-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 15px;
        padding: 15px;
      }
      
      header h1 {
        font-size: 1.3rem;
      }
      
      .channel-img {
        height: 120px;
      }
      
      #searchInput.active {
        width: 180px;
      }
    }
    
    @media (max-width: 480px) {
      .channels-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      }
      
      #searchInput.active {
        width: 140px;
      }
      
      .channel-img {
        height: 100px;
      }
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ */
    .player-guide {
      background: linear-gradient(135deg, #fff, #f9f9f9);
      color: #333;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      max-width: 90%;
      width: 300px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }
    
    .player-guide h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: #e53935;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .player-guide p {
      font-size: 1.1rem;
      line-height: 0.8;
      margin-bottom: 15px;
    }
    
    .player-guide .icon-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 25px 0;
    }
    
    .player-guide .icon {
      background: #1e88e5;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      color: white;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .player-guide .btn-blue {
      background: #1e88e5;
      color: #fff;
      font-weight: bold;
      padding: 10px 14px;
      font-size: 1.2rem;
      border-radius: 6px 4px;
      margin-top: 10px;
    }
    
    .player-guide .btn-blue:hover {
      transform: translateY(1px) scale(1.05);
      box-shadow: 0 6px 15px rgba(0,0,0,0.2);
    }
    
    .player-guide .btn-blue:active {
      transform: translateY(1px);
    }
    
    .instruction-arrow {
      display: block;
      font-size: 2.5rem;
      margin: 15px 0;
      color: #1e88e5;
      animation: bounce 1.5s infinite;
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    .remember-container {
      margin: 15px 0;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .remember-container input {
      width: 18px;
      height: 18px;
    }
    
    /* Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§ØªØµØ§Ù„ */
    .contact-form {
      width: 100%;
      max-width: 500px;
      padding: 20px;
      background: #fff;
      border-radius: 6px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }
    
    .form-group {
      margin-bottom: 10px;
      text-align: right;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #333;
    }
    
    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 10px 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }
    
    .form-group input:focus,
    .form-group textarea:focus {
      border-color: var(--blue-btn);
      outline: none;
    }
    
    .form-actions {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    
    .btn-form {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s;
      font-weight: bold;
    }
    
    .btn-send {
      background: var(--blue-btn);
      color: white;
    }
    
    .btn-cancel {
      background: var(--red-btn);
      color: white;
    }
    
    .btn-send:hover, .btn-cancel:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }
    
    .contact-success {
      text-align: center;
      padding: 20px;
    }
    
    .contact-success i {
      font-size: 3rem;
      color: #4CAF50;
      margin-bottom: 15px;
    }
    
    /* Ø±Ø³Ø§Ù„Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
    .protection-message {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(229, 57, 53, 0.9);
      color: white;
      padding: 10px 15px;
      border-radius: 5px;
      font-size: 0.9rem;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      animation: fadeIn 0.5s;
    }
  </style>
</head>
<body>
  <div id="loadingOverlay">
    <div class="spinner"><i class="fas fa-spinner"></i></div>
    <div>Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª...</div>
  </div>
  
  <div id="modal" class="modal hidden">
    <div class="modal-content" id="modalContent"></div>
  </div>
  
  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù…Ø¹ Ø®ÙŠØ§Ø± "Ù„Ø§ ØªØ¸Ù‡Ø± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰" -->
  <div id="playerGuideModal" class="modal hidden">
    <div class="player-guide">
      <h3>Ù„ØªØ¬Ø±Ø¨Ø© Ù…Ø´Ø§Ù‡Ø¯Ø© Ø£ÙØ¶Ù„</h3>
      <p>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§ØªØ¨Ø§Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ©:</p>
      
      <div class="icon-container">
        <div class="icon">
          <i class="fas fa-expand"></i>
        </div>
        <div class="instruction-arrow">
          <i class="fas fa-long-arrow-alt-right"></i>
        </div>
        <div class="icon">
          <i class="fas fa-mobile-alt"></i>
        </div>
      </div>
      
      <p>1. Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©</p>
      <p>2. Ù‚Ù… Ø¨ØªØ¯ÙˆÙŠØ± Ø¬Ù‡Ø§Ø²Ùƒ Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø£ÙÙ‚ÙŠ</p>

      
      <div class="remember-container">
        <input type="checkbox" id="dontShowAgain">
        <label for="dontShowAgain">Ù„Ø§ ØªØ¸Ù‡Ø± Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰</label>
      </div>
      
      <button id="guideConfirm" class="btn-blue">ÙÙ‡Ù…ØªØŒ Ø´ÙƒØ±Ø§Ù‹</button>
    </div>
  </div>
  
  <div id="sidebar">
    <div class="sidebar-header">
      <div class="logo-container">
      <img src="https://raw.githubusercontent.com/hala-tv-live/channels-data/refs/heads/main/logo.png" alt="Logo">
        <div class="logo-text">Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ</div>
      </div>
      <button id="closeSidebar"><i class="fas fa-times"></i></button>
    </div>
    
    <div class="section-title">Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</div>
    <nav class="categories"></nav>
    
    <a href="#" id="aboutApp" class="about-item">
      <i class="fas fa-info-circle"></i>
      <span>Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
      <i class="fas fa-chevron-down" style="margin-right: auto; font-size: 0.9rem;"></i>
    </a>
    <div class="about-links" id="aboutLinks">
      <a href="#" class="about-link" data-type="website">
        <i class="fas fa-globe"></i>
        <span>Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</span>
      </a>
      <a href="#" class="about-link" data-type="privacy">
        <i class="fas fa-shield-alt"></i>
        <span>Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</span>
      </a>
      <a href="#" class="about-link" data-type="terms">
        <i class="fas fa-file-alt"></i>
        <span>Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</span>
      </a>
      <a href="#" class="about-link" data-type="contact">
        <i class="fas fa-envelope"></i>
        <span>Ø§ØªØµÙ„ Ø¨Ù†Ø§</span>
      </a>
    </div>
  </div>
  
  <main>
    <header id="mainHeader">
      <button id="menuToggle"><i class="fas fa-bars"></i></button>
      <h1>Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ</h1>
      <div class="search-container">
        <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ù†Ø§Ø©...">
        <button id="searchBtn"><i class="fas fa-search"></i></button>
        <button id="clearSearch"><i class="fas fa-times"></i></button>
      </div>
    </header>
    
    <div class="channels-grid" id="channelsContainer">
      <!-- Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
    </div>
    
    <div class="app-footer">
      ØªØ·Ø¨ÙŠÙ‚ Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ _Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ù‡
    </div>
  </main>
  
  <div id="videoPlayer">
    <button id="closePlayer"><i class="fas fa-times"></i></button>
    <video id="player" playsinline controls></video>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
  
  <script>
    // Ø¯Ø§Ù„Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
    function showToast(msg, type = 'info', duration = 1000) {
      const bg = { 
        success: 'linear-gradient(to right, #1e90ff, #1e90ff)', 
        info: 'linear-gradient(to right, #3498db, #1e88e5)',
        warning: 'linear-gradient(to right, #000000, #000000)',
        error: 'linear-gradient(to right, #e53935, #c62828)'
      }[type];
      
      Toastify({ 
        text: msg, 
        duration, 
        gravity: 'bottom', 
        position: 'right',
        style: { 
          background: bg,
          borderRadius: '4px',
          boxShadow: '0 4px 12px rgba(0,0,0,0.15)'
        },
        className: "toast-" + type
      }).showToast();
    }
    
    // Ø¹Ù†Ø§ØµØ± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modalContent');
    const loadingOverlay = document.getElementById('loadingOverlay');
    const menuToggle = document.getElementById('menuToggle');
    const sidebar = document.getElementById('sidebar');
    const closeSidebar = document.getElementById('closeSidebar');
    const searchBtn = document.getElementById('searchBtn');
    const searchInput = document.getElementById('searchInput');
    const clearSearch = document.getElementById('clearSearch');
    const channelsContainer = document.getElementById('channelsContainer');
    const categoriesNav = document.querySelector('.categories');
    const videoPlayer = document.getElementById('videoPlayer');
    const playerElem = document.getElementById('player');
    const aboutApp = document.getElementById('aboutApp');
    const aboutLinks = document.getElementById('aboutLinks');
    const closePlayerBtn = document.getElementById('closePlayer');
    const mainHeader = document.getElementById('mainHeader');
    const dontShowAgainCheckbox = document.getElementById('dontShowAgain');
    
    // Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
    const playerGuideModal = document.getElementById('playerGuideModal');
    const guideConfirm = document.getElementById('guideConfirm');
    
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    let channels = [];
    let currentCategory = 'all';
    let hls;
    
    // ØªÙ‡ÙŠØ¦Ø© Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    const player = new Plyr(playerElem, { 
      controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'settings', 'fullscreen'], 
      settings: ['quality', 'speed'],
      invertTime: false
    });
    
    // Ø¹Ù†ÙˆØ§Ù† Ù…Ù„Ù Ø§Ù„Ù‚Ù†ÙˆØ§Øª
    const JSON_URL = 'https://raw.githubusercontent.com/hala-tv-live/channels-data/main/channels.json';
    
    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.addEventListener('DOMContentLoaded', () => {
      initListeners();
      loadChannels();
      detectOrientation();
      setupScrollEffect();
      setupContentProtection(); // Ø¥Ø¹Ø¯Ø§Ø¯ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    });
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙ…Ø±ÙŠØ± Ù„ØªØµØºÙŠØ± Ø§Ù„Ù‡ÙŠØ¯Ø±
    function setupScrollEffect() {
      window.addEventListener('scroll', () => {
        if (window.scrollY > 20) {
          mainHeader.classList.add('scrolled');
        } else {
          mainHeader.classList.remove('scrolled');
        }
      });
    }
    
    // Ø¥Ø¹Ø¯Ø§Ø¯ Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù…Ù† Ø§Ù„Ù†Ø³Ø®
    function setupContentProtection() {
      // Ù…Ù†Ø¹ Ø§Ù„Ù†Ù‚Ø± Ø¨Ø²Ø± Ø§Ù„Ù…Ø§ÙˆØ³ Ø§Ù„Ø£ÙŠÙ…Ù†
      document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
        showToast('âŒ Ø§Ù„Ù†Ø³Ø® ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚', 'error', 2000);
      });
      
      // Ù…Ù†Ø¹ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Øµ
      document.addEventListener('selectstart', function(e) {
        e.preventDefault();
        showToast('âŒ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù†Øµ ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡', 'error', 1500);
      });
      
      // Ù…Ù†Ø¹ Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
      document.addEventListener('dragstart', function(e) {
        e.preventDefault();
      });
      
      // Ù…Ù†Ø¹ Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ù†Ø³Ø® (Ctrl+C)
      document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && (e.key === 'c' || e.key === 'C' || e.keyCode === 67)) {
          e.preventDefault();
          showToast('âŒ Ø§Ù„Ù†Ø³Ø® ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚', 'error', 2000);
        }
        
        // Ù…Ù†Ø¹ ÙØªØ­ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ† (F12, Ctrl+Shift+I, Ctrl+Shift+C)
        if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i' || e.key === 'C' || e.key === 'c'))) {
          e.preventDefault();
          showToast('âŒ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡', 'error', 2000);
        }
      });
      
      // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¨Ø´ÙƒÙ„ Ø¯ÙˆØ±ÙŠ
      setInterval(() => {
        showContentProtectionMessage();
      }, 300000); // ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
    }
    
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰
    function showContentProtectionMessage() {
      const existingMessage = document.querySelector('.protection-message');
      if (existingMessage) {
        existingMessage.remove();
      }
      
      const message = document.createElement('div');
      message.className = 'protection-message';
      message.innerHTML = 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©. Ø§Ù„Ù†Ø³Ø® ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ù‡. <i class="fas fa-shield-alt"></i>';
      
      document.body.appendChild(message);
      
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
      setTimeout(() => {
        if (message.parentNode) {
          message.parentNode.removeChild(message);
        }
      }, 5000);
    }
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ù„Ù„Ø£Ø­Ø¯Ø§Ø«
    function initListeners() {
      menuToggle.onclick = () => sidebar.classList.toggle('open');
      closeSidebar.onclick = () => sidebar.classList.remove('open');
      
      searchBtn.onclick = () => {
        searchInput.classList.toggle('active');
        if (searchInput.classList.contains('active')) {
          searchInput.focus();
        } else {
          clearSearchInput();
        }
      };
      
      searchInput.oninput = debounce(e => {
        renderChannels(filterByTerm(e.target.value));
        toggleClearButton(e.target.value);
      }, 300);
      
      clearSearch.onclick = () => {
        clearSearchInput();
      };
      
      categoriesNav.onclick = e => {
        const a = e.target.closest('a');
        if (a) {
          currentCategory = a.dataset.cat;
          updateCategories();
          renderChannels(filterByCategory());
        }
      };
      
      window.addEventListener('popstate', () => {
        if (videoPlayer.style.display === 'block') closeVideo();
      });
      
      window.addEventListener('offline', () => showToast('âŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø§ØªØµØ§Ù„ Ø¥Ù†ØªØ±Ù†Øª!', 'error'));
      window.addEventListener('online', () => showToast('âœ… ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø§ØªØµØ§Ù„', 'success'));
      
      // Ø£Ø­Ø¯Ø§Ø« Ù‚Ø³Ù… Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
      aboutApp.onclick = () => {
        aboutLinks.classList.toggle('expanded');
      };
      
      // Ø£Ø­Ø¯Ø§Ø« Ø±ÙˆØ§Ø¨Ø· Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
      document.querySelectorAll('.about-link').forEach(link => {
        link.onclick = (e) => {
          e.preventDefault();
          const type = link.dataset.type;
          
          // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
          const info = {
            website: {
              title: "Ø­ÙˆÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚",
              message: "Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ù‚Ù†ÙˆØ§Øª:_ØªØ­ÙƒÙ… Ø£Ø³Ù‡Ù„_ØªØ´ØºÙŠÙ„ Ø£Ø³Ø±Ø¹_ØªÙˆÙÙŠØ± Ø£ÙƒØ«Ø±..... Ø±Ù‚Ù… Ø§Ù„Ø¥ØµØ¯Ø§Ø±: 1.0.",
              link: "https://halatv-live.blogspot.com/2025/06/hala-tv-live.html",
              icon: "fas fa-globe"
            },
            privacy: {
              title: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©",
              message: "ØªØ¹Ø±Ù Ø¹Ù„Ù‰ ÙƒÙŠÙÙŠØ© ØªØ¹Ø§Ù…Ù„Ù†Ø§ Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆØ­Ù…Ø§ÙŠØ© Ø®ØµÙˆØµÙŠØªÙƒ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚.",
              link: "https://halatv-live.blogspot.com/p/privacy",
              icon: "fas fa-shield-alt"
            },
            terms: {
              title: "Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…",
              message: "Ø§Ù‚Ø±Ø£ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù… Ø§Ù„ØªÙŠ ØªØ­ÙƒÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ùƒ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ®Ø¯Ù…Ø§ØªÙ†Ø§ Ø§Ù„Ù…Ø®ØªÙ„ÙØ©.",
              link: "https://halatv-live.blogspot.com/p/terms",
              icon: "fas fa-file-alt"
            },
            contact: {
              title: "Ø§ØªØµÙ„ Ø¨Ù†Ø§",
              message: "Ù„Ø¯ÙŠÙƒ Ø§Ø³ØªÙØ³Ø§Ø± Ø£Ùˆ Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ Ù„Ø§ ØªØªØ±Ø¯Ø¯ ÙÙŠ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ ÙØ±ÙŠÙ‚ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ù†Ø§.",
              icon: "fas fa-envelope"
            }
          };
          
          // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„Ø±Ø§Ø¨Ø·
          if (type === 'contact') {
            showContactForm();
          } else {
            showInfoModal(info[type]);
          }
        };
      });
      
      // Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ù„Ø²Ø± Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© ÙÙŠ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡
      guideConfirm.onclick = () => {
        if (dontShowAgainCheckbox.checked) {
          localStorage.setItem('guideShown', 'true');
        }
        playerGuideModal.classList.add('hidden');
      };
      
      // Ù…Ø³ØªÙ…Ø¹ Ù„Ø²Ø± Ø¥ØºÙ„Ø§Ù‚ Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
      closePlayerBtn.onclick = closeVideo;
      
      // Ù…Ø³ØªÙ…Ø¹ Ù„Ù„Ø¶ØºØ· Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´ØºÙ„ Ù„Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
      playerElem.addEventListener('dblclick', () => {
        if (player.fullscreen.active) {
          player.exitFullscreen();
        } else {
          player.enterFullscreen();
        }
      });
    }
    
    // Ø¯Ø§Ù„Ø© Ù„ØªÙØ§Ø¯ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªÙƒØ±Ø± Ù„Ù„Ø¨Ø­Ø«
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }
    
    // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø²Ø± Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«
    function toggleClearButton(value) {
      if (value) {
        clearSearch.classList.add('visible');
      } else {
        clearSearch.classList.remove('visible');
      }
    }
    
    // Ù…Ø³Ø­ Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«
    function clearSearchInput() {
      searchInput.value = '';
      searchInput.classList.remove('active');
      clearSearch.classList.remove('visible');
      renderChannels(filterByCategory());
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§ØªØµØ§Ù„
    function showContactForm() {
      modalContent.innerHTML = `
        <h3>Ø§ØªØµÙ„ Ø¨Ù†Ø§</h3>
        <div class="contact-form">
          <form id="contactForm">
            <div class="form-group">
              <label for="name">Ø§Ù„Ø§Ø³Ù…:</label>
              <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
              <label for="email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
              <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
              <label for="message">Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</label>
              <textarea id="message" name="message" rows="4" required></textarea>
            </div>
            <div class="form-actions">
              <button type="button" id="cancelContact" class="btn-form btn-cancel">Ø¥Ù„ØºØ§Ø¡</button>
              <button type="submit" class="btn-form btn-send">Ø¥Ø±Ø³Ø§Ù„</button>
            </div>
          </form>
        </div>
      `;
      
      modal.classList.remove('hidden');
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯ Ù„Ø²Ø± Ø§Ù„Ø¥Ù„ØºØ§Ø¡
      document.getElementById('cancelContact').onclick = hideModal;
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('contactForm').onsubmit = sendContactForm;
      
      // Ø¥Ø¯Ø§Ø±Ø© Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ù‡Ø§ØªÙ
      history.pushState({ modalOpen: true }, '');
      window.addEventListener('popstate', handleBackButton);
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø§ØªØµØ§Ù„
    function sendContactForm(e) {
      e.preventDefault();
      
      // ÙÙŠ Ø¨ÙŠØ¦Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ø³ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§ ÙƒÙˆØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
      // Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø®Ø¯Ù…Ø© Ù…Ø«Ù„ Formspree Ø£Ùˆ EmailJS
      
      // ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„ Ø³Ù†Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ ÙÙ‚Ø·
      modalContent.innerHTML = `
        <div class="contact-success">
          <i class="fas fa-check-circle"></i>
          <h3>ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­</h3>
          <p>Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙˆØ§ØµÙ„Ùƒ Ù…Ø¹Ù†Ø§ØŒ Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙƒ ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª.</p>
          <button id="closeSuccess" class="btn-blue">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      `;
      
      document.getElementById('closeSuccess').onclick = hideModal;
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ ÙÙŠ Ø§Ù„Ù‡Ø§ØªÙ
    function handleBackButton() {
      if (modal.classList.contains('hidden') === false) {
        hideModal();
      }
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ù„Ø±Ø§Ø¨Ø·
    function showInfoModal(info) {
      modalContent.innerHTML = `
        <h3>${info.title}</h3>
        <p>${info.message}</p>
        <a href="${info.link}" target="_blank" class="info-link">
          <i class="${info.icon}"></i> Ø§Ø¶ØºØ· Ù‡Ù†Ø§ Ù„Ù„Ø§Ù†ØªÙ‚Ø§Ù„
        </a>
        <button id="infoClose" class="btn-blue" style="margin-top: 10px;">Ø¥ØºÙ„Ø§Ù‚</button>
      `;
      
      modal.classList.remove('hidden');
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ø¬Ø¯ÙŠØ¯ Ù„Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
      document.getElementById('infoClose').onclick = hideModal;
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø§Ù„Ø¹Ø§Ù…Ø© (Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„)
    function showErrorModal(message, showRetry = false) {
      modalContent.innerHTML = `
        <p>${message}</p>
        <div>
          ${showRetry ? '<button id="modalRetry" class="btn-red">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>' : ''}
          <button id="modalConfirm" class="btn-blue">Ù…ÙˆØ§ÙÙ‚</button>
        </div>
      `;
      
      modal.classList.remove('hidden');
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹Ø§Øª Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
      document.getElementById('modalConfirm').onclick = hideModal;
      if (showRetry) {
        document.getElementById('modalRetry').onclick = () => {
          hideModal();
          loadChannels();
        };
      }
    }
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
    function hideModal() {
      modal.classList.add('hidden');
      window.removeEventListener('popstate', handleBackButton);
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ù…Ù† Ø§Ù„Ù…Ù„Ù
    async function loadChannels() {
      loadingOverlay.style.display = 'flex';
      
      try {
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 20000);
        
        const res = await fetch(JSON_URL, { signal: controller.signal });
        clearTimeout(timeoutId);
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†Ø¬Ø§Ø­ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
        if (!res.ok) throw new Error('ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
        
        channels = await res.json();
        channels.forEach((c, i) => c.id = i);
        
        // ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø¨Ù†Ø¬Ø§Ø­
        updateCategories();
        renderChannels(channels);
        showToast('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
      } catch (error) {
        // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ù„Ø© ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø£ÙŠ Ù‚Ù†ÙˆØ§Øª
        if (channels.length === 0) {
          showErrorModal('âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†ÙˆØ§Øª! Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©', true);
        } else {
          // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ù‚Ù†ÙˆØ§Øª Ù…Ø­Ù…Ù„Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ØŒ ÙÙ‚Ø· Ø£Ø¸Ù‡Ø± ØªÙ†Ø¨ÙŠÙ‡
          showToast('âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚Ù†ÙˆØ§ØªØŒ Ø¬Ø§Ø±Ù Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©', 'warning');
        }
      } finally {
        loadingOverlay.style.display = 'none';
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª Ù…Ø¹ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù…Ù†Ø§Ø³Ø¨Ø© Ù„ÙƒÙ„ ÙØ¦Ø©
    function updateCategories() {
      const cats = ['all', ...new Set(channels.map(c => c.category))];
      categoriesNav.innerHTML = cats.map(cat => {
        let icon = 'fas fa-tv';
        let label = cat;
        
        if (cat === 'all') {
          icon = 'fas fa-home';
          label = 'Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
        } else {
          // ØªØ®ØµÙŠØµ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ù„Ù„ÙØ¦Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
          switch (cat.toLowerCase()) {
            case 'Ø±ÙŠØ§Ø¶ÙŠØ©':
            case 'Ø±ÙŠØ§Ø¶Ø©':
              icon = 'fas fa-futbol';
              break;
            case 'Ø£Ø®Ø¨Ø§Ø±':
              icon = 'fas fa-newspaper';
              break;
            case 'ØªØ±ÙÙŠÙ‡':
              icon = 'fas fa-film';
              break;
            case 'Ø£Ø·ÙØ§Ù„':
              icon = 'fas fa-child';
              break;
            case 'ÙˆØ«Ø§Ø¦Ù‚ÙŠØ©':
              icon = 'fas fa-globe';
              break;
            case 'Ø¯ÙŠÙ†ÙŠØ©':
              icon = 'fas fa-mosque';
              break;
            case 'ØªØ¹Ù„ÙŠÙ…ÙŠØ©':
              icon = 'fas fa-graduation-cap';
              break;
            case 'Ù…ÙˆØ³ÙŠÙ‚Ù‰':
              icon = 'fas fa-music';
              break;
            case 'Ø³ÙŠØ§Ø³Ø©':
              icon = 'fas fa-landmark';
              break;
            case 'Ø§Ù‚ØªØµØ§Ø¯':
              icon = 'fas fa-chart-line';
              break;
            case 'Ø£ÙÙ„Ø§Ù…':
              icon = 'fas fa-video';
              break;
            case 'Ù…Ø³Ù„Ø³Ù„Ø§Øª':
              icon = 'fas fa-tv';
              break;
            case 'Ø¨Ø±Ø§Ù…Ø¬':
              icon = 'fas fa-microphone-alt';
              break;
          }
        }
        
        return `
          <a href='#' data-cat='${cat}' class='${cat === currentCategory ? 'active' : ''}'>
            <i class='${icon}'></i>
            <span>${label}</span>
          </a>
        `;
      }).join('');
    }
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ù†ÙˆØ§Øª
    function renderChannels(list) {
      channelsContainer.innerHTML = '';
      
      if (!list.length) {
        channelsContainer.innerHTML = `
          <div class="no-results">
            <i class="fas fa-tv"></i>
            <div>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ù†ÙˆØ§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</div>
          </div>
        `;
        return;
      }
      
      list.forEach(ch => {
        if (currentCategory !== 'all' && ch.category !== currentCategory) {
          return;
        }
        
        const card = document.createElement('div');
        card.className = 'channel-card';
        
        card.innerHTML = `
          <img class='channel-img' src='${ch.logo}' alt='${ch.name}' onerror="this.src='data:image/svg+xml;charset=UTF-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22200%22%20height%3D%22200%22%20viewBox%3D%220%200%20200%20200%22%3E%3Crect%20fill%3D%22%23f5f5f5%22%20width%3D%22200%22%20height%3D%22200%22%2F%3E%3Ctext%20fill%3D%22%23666%22%20font-family%3D%22Arial%22%20font-size%3D%2218%22%20x%3D%22100%22%20y%3D%22100%22%20text-anchor%3D%22middle%22%20dominant-baseline%3D%22middle%22%3E${ch.name}%3C%2Ftext%3E%3C%2Fsvg%3E'">
          <div class='channel-info'>
            <div class='channel-name'>${ch.name}</div>
            <div class='channel-category'>${ch.category}</div>
          </div>
        `;
        
        card.onclick = () => openPlayer(ch.stream_url, ch.name);
        channelsContainer.appendChild(card);
      });
    }
    
    // ÙÙ„ØªØ±Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
    function filterByCategory() {
      if (currentCategory === 'all') return channels;
      return channels.filter(c => c.category === currentCategory);
    }
    
    // ÙÙ„ØªØ±Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¨Ø­Ø«
    function filterByTerm(term) {
      return filterByCategory().filter(c => 
        c.name.toLowerCase().includes(term.toLowerCase()) || 
        c.category.toLowerCase().includes(term.toLowerCase())
      );
    }
    
    // ÙØªØ­ Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ - Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù‡Ù†Ø§
    function openPlayer(url, name) {
      document.title = `Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ - ${name}`;
      videoPlayer.style.display = 'block';
      history.pushState({ playerOpen: true }, '');
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ ÙÙ‚Ø· Ø¥Ø°Ø§ Ù„Ù… ØªØ¸Ù‡Ø± Ù…Ù† Ù‚Ø¨Ù„
      if (!localStorage.getItem('guideShown')) {
        playerGuideModal.classList.remove('hidden');
      }
      
      if (hls) hls.destroy();
      
      // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø· ÙˆÙ…Ø¹Ø§Ù„Ø¬ØªÙ‡ Ø¨Ø´ÙƒÙ„ Ù…Ù†Ø§Ø³Ø¨
      if (url.toLowerCase().includes('.m3u8')) {
        // Ø±Ø§Ø¨Ø· HLS
        if (Hls.isSupported()) {
          hls = new Hls();
          hls.loadSource(url);
          hls.attachMedia(playerElem);
          
          hls.on(Hls.Events.MANIFEST_PARSED, () => {
            player.play();
            showToast(`Ø¬Ø§Ø±Ù ØªØ´ØºÙŠÙ„: ${name}`, 'info');
          });
          
          hls.on(Hls.Events.ERROR, (e, data) => {
            if (data.fatal) {
              if (data.type === Hls.ErrorTypes.NETWORK_ERROR) {
                showToast('âš ï¸ Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ù„Ø´Ø¨ÙƒØ© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„', 'warning');
              } else if (data.type === Hls.ErrorTypes.MEDIA_ERROR) {
                hls.recoverMediaError();
              }
            }
          });
        } else if (playerElem.canPlayType('application/vnd.apple.mpegurl')) {
          playerElem.src = url;
          player.play();
          showToast(`Ø¬Ø§Ø±Ù ØªØ´ØºÙŠÙ„: ${name}`, 'info');
        } else {
          showToast('âš ï¸ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ´ØºÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ', 'error');
        }
      } else if (url.toLowerCase().includes('.ts')) {
        // Ø±Ø§Ø¨Ø· TS Ù…Ø¨Ø§Ø´Ø± - Ù†Ø³ØªØ®Ø¯Ù…Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© ÙƒÙ…ØµØ¯Ø± Ù„Ù„ÙÙŠØ¯ÙŠÙˆ
        playerElem.src = url;
        player.play();
        showToast(`Ø¬Ø§Ø±Ù ØªØ´ØºÙŠÙ„: ${name}`, 'info');
      } else {
        // Ø±Ø§Ø¨Ø· ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ - Ù†Ø­Ø§ÙˆÙ„ ØªØ´ØºÙŠÙ„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©
        playerElem.src = url;
        player.play();
        showToast(`Ø¬Ø§Ø±Ù ØªØ´ØºÙŠÙ„: ${name}`, 'info');
      }
    }
    
    // Ø¥ØºÙ„Ø§Ù‚ Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
    function closeVideo() {
      document.title = 'Ù‡Ù„Ø§ ØªÙŠ ÙÙŠ';
      videoPlayer.style.display = 'none';
      player.pause();
      playerElem.src = '';
      
      if (hls) {
        hls.destroy();
        hls = null;
      }
      
      if (history.state && history.state.playerOpen) {
        history.back();
      }
    }
    
    // ÙƒØ´Ù Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø´Ø§Ø´Ø©
    function detectOrientation() {
      if (window.screen.orientation) {
        window.screen.orientation.addEventListener('change', function() {
          if (window.screen.orientation.type.includes('landscape')) {
            showToast('ğŸ’¡ Ù„Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠØŒ Ù‚Ù… Ø¨ØªØ¯ÙˆÙŠØ± Ø¬Ù‡Ø§Ø²Ùƒ', 'info', 2000);
          }
        });
      }
    }
  </script>
</body>
</html>